-- RAFEEYL Auto Teleport (Waypoint Permanen + Save + Copy + Auto Respawn + Fly Universal)
-- Fly Support PC + HP + Slider Speed + Tombol Naik/Turun (HP Friendly)

local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

-- ğŸ‘‡ Masukkan waypoint hasil salin clipboard ke sini
local waypoints = {
    {name = "Gunung Cicok", pos = Vector3.new(-161.89, 1598.15, -2141.80)},
    {name = "Puncak Lava", pos = Vector3.new(150.12, 80.77, 90.55)},
    {name = "Summit Salju", pos = Vector3.new(180.77, 92.15, 75.32)}
}

-- ğŸ§© Setting awal
local running = false
local autoRespawn = true
local delaySeconds = 5
local loopCoroutine
local respawnLoop

-- âœˆï¸ Fly settings
local flying = false
local flySpeed = 60
local bodyGyro, bodyVel
local flyVertical = 0 -- buat naik/turun dari tombol HP

-- Helper
local function getHRP()
    local c = player.Character
    if not c then return nil end
    return c:FindFirstChild("HumanoidRootPart")
end

local function teleportTo(pos)
    local hrp = getHRP()
    if hrp then
        hrp.CFrame = CFrame.new(pos + Vector3.new(0, 3, 0))
    end
end

-- ğŸ” Auto respawn
local function startAutoRespawn()
    if respawnLoop then return end
    respawnLoop = coroutine.create(function()
        while autoRespawn do
            player:LoadCharacter()
            Rayfield:Notify({
                Title = "Auto Respawn",
                Content = "Respawn otomatis dilakukan.",
                Duration = 1.5
            })
            task.wait(delaySeconds)
        end
    end)
    coroutine.resume(respawnLoop)
end

local function stopAutoRespawn()
    autoRespawn = false
    respawnLoop = nil
end

-- ğŸš€ Fly universal (PC + HP)
local function startFly()
    local hrp = getHRP()
    if not hrp then return end
    flying = true

    bodyGyro = Instance.new("BodyGyro")
    bodyGyro.P = 9e4
    bodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    bodyGyro.CFrame = hrp.CFrame
    bodyGyro.Parent = hrp

    bodyVel = Instance.new("BodyVelocity")
    bodyVel.Velocity = Vector3.zero
    bodyVel.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVel.Parent = hrp

    Rayfield:Notify({
        Title = "ğŸ•Šï¸ Fly Aktif",
        Content = "PC: W A S D / Space / Shift | HP: Gunakan joystick + tombol Naik/Turun",
        Duration = 5
    })

    local cam = workspace.CurrentCamera

    RunService.RenderStepped:Connect(function()
        if flying and hrp and bodyGyro and bodyVel then
            bodyGyro.CFrame = cam.CFrame
            local moveDir = Vector3.zero

            -- Kontrol PC
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir += cam.CFrame.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir -= cam.CFrame.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir -= cam.CFrame.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir += cam.CFrame.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDir += Vector3.new(0, 1, 0) end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveDir -= Vector3.new(0, 1, 0) end

            -- Kontrol HP (Joystick)
            local humanoid = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
            if humanoid and humanoid.MoveDirection.Magnitude > 0 then
                moveDir = humanoid.MoveDirection
            end

            -- Tambah naik/turun manual
            moveDir += Vector3.new(0, flyVertical, 0)

            bodyVel.Velocity = moveDir * flySpeed
        elseif not flying then
            if bodyGyro then bodyGyro:Destroy() bodyGyro = nil end
            if bodyVel then bodyVel:Destroy() bodyVel = nil end
        end
    end)
end

local function stopFly()
    flying = false
    flyVertical = 0
    if bodyGyro then bodyGyro:Destroy() bodyGyro = nil end
    if bodyVel then bodyVel:Destroy() bodyVel = nil end
    Rayfield:Notify({
        Title = "ğŸ•Šï¸ Fly Nonaktif",
        Content = "Mode terbang dimatikan.",
        Duration = 2
    })
end

-- ğŸ” Auto teleport loop
local function startLoop()
    if running or #waypoints == 0 then
        warn("[RAFEEYL] Tidak ada waypoint permanen!")
        return
    end
    running = true

    if autoRespawn then startAutoRespawn() end

    loopCoroutine = coroutine.create(function()
        local idx = 1
        while running do
            local wp = waypoints[idx]
            teleportTo(wp.pos)
            Rayfield:Notify({
                Title = "Teleporting...",
                Content = "Menuju lokasi: " .. wp.name,
                Duration = 2
            })
            idx += 1
            if idx > #waypoints then idx = 1 end
            task.wait(delaySeconds)
        end
    end)
    coroutine.resume(loopCoroutine)
end

-- ğŸªŸ GUI
local Window = Rayfield:CreateWindow({
    Name = "RAFEEYL - Auto Teleport",
    LoadingTitle = "RAFEEYL",
    LoadingSubtitle = "Permanent Summit Universal"
})

local Tab = Window:CreateTab("Teleport", 4483362458)

-- ğŸ’¾ Save Posisi
Tab:CreateButton({
    Name = "ğŸ’¾ Save Posisi (Copy ke Clipboard)",
    Callback = function()
        local hrp = getHRP()
        if not hrp then
            Rayfield:Notify({
                Title = "Gagal",
                Content = "Tidak dapat menemukan posisi karakter!",
                Duration = 2
            })
            return
        end

        local pos = hrp.Position
        local text = string.format("Vector3.new(%.2f, %.2f, %.2f)", pos.X, pos.Y, pos.Z)
        if setclipboard then
            setclipboard(text)
            Rayfield:Notify({
                Title = "Posisi Disalin!",
                Content = text,
                Duration = 3
            })
        else
            Rayfield:Notify({
                Title = "Clipboard Tidak Didukung",
                Content = "Executor kamu tidak mendukung setclipboard!",
                Duration = 3
            })
        end
    end
})

-- â–¶ï¸ Start Auto Teleport
Tab:CreateButton({
    Name = "â–¶ï¸ Start Auto Teleport",
    Callback = function()
        running = true
        autoRespawn = true
        startLoop()
        Rayfield:Notify({
            Title = "Started",
            Content = "Auto Teleport + Auto Respawn aktif.",
            Duration = 2
        })
    end
})

-- â¹ Stop Semua
Tab:CreateButton({
    Name = "â¹ Stop Semua",
    Callback = function()
        running = false
        stopAutoRespawn()
        stopFly()
        Rayfield:Notify({
            Title = "Stopped",
            Content = "Semua fitur dihentikan.",
            Duration = 2
        })
    end
})

-- ğŸ•Šï¸ Fly Toggle
Tab:CreateButton({
    Name = "ğŸ•Šï¸ Fly (ON/OFF)",
    Callback = function()
        if flying then stopFly() else startFly() end
    end
})

-- âš¡ Slider Kecepatan Fly
Tab:CreateSlider({
    Name = "âš¡ Kecepatan Fly",
    Range = {10, 200},
    Increment = 5,
    Suffix = "Speed",
    CurrentValue = flySpeed,
    Callback = function(v)
        flySpeed = v
        Rayfield:Notify({
            Title = "Kecepatan Fly",
            Content = "Kecepatan diubah ke " .. tostring(v),
            Duration = 2
        })
    end
})

-- ğŸ”¼ Tombol Naik
Tab:CreateButton({
    Name = "ğŸ”¼ Naik (HP)",
    Callback = function()
        flyVertical = 1
        task.delay(0.5, function() flyVertical = 0 end)
    end
})

-- ğŸ”½ Tombol Turun
Tab:CreateButton({
    Name = "ğŸ”½ Turun (HP)",
    Callback = function()
        flyVertical = -1
        task.delay(0.5, function() flyVertical = 0 end)
    end
})

-- ğŸŒ Teleport Manual
for _, wp in ipairs(waypoints) do
    Tab:CreateButton({
        Name = "ğŸŒ Teleport ke: " .. wp.name,
        Callback = function()
            teleportTo(wp.pos)
            Rayfield:Notify({
                Title = "Teleport Manual",
                Content = "Berhasil teleport ke " .. wp.name,
                Duration = 2
            })
        end
    })
end
